% !TeX encoding = windows-1251
\section{Архитектура приложения и формализация задачи}

\subsection{Описание мобильного приложения}

Мобильное приложение, разработанное на платформе Flutter, представляет собой современный клиент для сервиса знакомств, ориентированный на сбор признаков пользователей и формирование персонализированных рекомендаций. Интерфейс построен вокруг свайп-механики, однако дополняется функциональностью, позволяющей учитывать более тонкие предпочтения, взаимодействовать с другими пользователями, а также заполнять собственный профиль.

После запуска пользователь попадает на экран входа в аккаунт (Рисунок~\ref{fig:login}). Этот экран обеспечивает точку входа в систему и привязку действий к конкретному идентификатору пользователя.

{
	\centering	
	\includegraphics[width=0.3\linewidth]{login.jpg}
	\captionof{figure}{Экран входа в аккаунт}
	\label{fig:login}
}

Главным элементом пользовательского опыта является блок рекомендаций. Здесь отображается список потенциальных партнёров, отсортированных по метрике сходства, которая принимает значения от $-100$ до $100$. Эта величина отражает уровень соответствия интересов между текущим пользователем и кандидатом, вычисляемый на основе тернарных признаков. 

Для каждого пользователя можно:
 
\begin{itemize}
\item перейти в профиль для просмотра подробной информации;
\item отправить заявку на чат, если он кажется интересным.
\end{itemize}

Пример данного экрана представлен на Рисунке~\ref{fig:recs}.

{
	\centering	
	\includegraphics[width=1\linewidth]{recomendations.jpg}
	\captionof{figure}{Экран с рекомендациями}
	\label{fig:recs}
}

Сбор признаков осуществляется с помощью системы тестов, оформленных в виде свайп-карточек. Каждый тест содержит вопросы на определённую тему, например, предпочтения в музыке. Пользователь может смахнуть карточку вправо (согласие), влево (несогласие) или вверх (пропуск), что формирует тернарный вектор ответов $q_i \in \{-1, 0, 1\}$. На карточке указывается, в какую сторону нужно свайпать, чтобы выбрать тот или иной ответ.

Интерфейс свайпа организован так, чтобы пользователь мог быстро и интуитивно отвечать на вопросы, минимизируя нагрузку и повышая вовлечённость. Сама механика свайпа показана на Рисунке~\ref{fig:swipe}.

{
	\centering	
	\includegraphics[width=0.3\linewidth]{swipe.jpg}
	\captionof{figure}{Пример карточки теста с механикой свайпа}
	\label{fig:swipe}
}

Профиль пользователя позволяет редактировать личную информацию, менять фотографию, а также переходить в настройки или выйти из аккаунта. Этот экран представлен на Рисунке~\ref{fig:profile}.

{
	\centering	
	\includegraphics[width=0.3\linewidth]{profile.jpg}
	\captionof{figure}{Экран профиля пользователя}
	\label{fig:profile}
}

Для администраторов предусмотрена возможность пополнять базу вопросов напрямую из приложения. Добавление нового вопроса в выбранную категорию осуществляется через специальный интерфейс (Рисунок~\ref{fig:create_answer}).

{
	\centering	
	\includegraphics[width=0.3\linewidth]{create_answer.jpg}
	\captionof{figure}{Интерфейс добавления вопроса администратором}
	\label{fig:create_answer}
}

Когда пользователь получает входящую заявку на общение, она отображается на отдельном экране. Здесь доступен выбор: принять или отклонить приглашение. Это помогает формировать согласованные чаты на основе взаимного интереса (Рисунок~\ref{fig:incoming}).

{
	\centering	
	\includegraphics[width=0.3\linewidth]{incoming.jpg}
	\captionof{figure}{Входящие заявки на чат}
	\label{fig:incoming}
}

Чат представляет собой полноценный мессенджер, позволяющий отправлять текстовые сообщения и прикреплять изображения. Также поддерживается возможность удаления диалогов, что даёт пользователям контроль над своим взаимодействием (Рисунок~\ref{fig:chat}).

{
	\centering	
	\includegraphics[width=0.3\linewidth]{chat.jpg}
	\captionof{figure}{Экран чата с поддержкой отправки изображений}
	\label{fig:chat}
}

Таким образом, мобильное приложение реализует весь цикл взаимодействия: от сбора предпочтений до установления контактов между пользователями. При этом особое внимание уделено простоте интерфейса и гибкости сбора признаков, что делает возможным последующее применение методов рекомендаций различной природы.

\subsection{Архитектура клиент-серверной системы}

Система построена по принципу микросервисной архитектуры с чётким разделением ответственности между клиентским приложением, серверной частью и модулем рекомендательной системы. Такое проектирование обеспечивает масштабируемость, возможность независимого обновления компонентов, а также гибкость в экспериментировании с различными алгоритмами на стороне рекомендаций.

В основе клиентской части лежит кроссплатформенное мобильное приложение, разработанное с использованием фреймворка Flutter. Оно обеспечивает интерактивный интерфейс для пользователя, включая регистрацию, прохождение тестов, просмотр рекомендаций, обмен сообщениями, а также базовое редактирование профиля. Приложение взаимодействует с серверной частью по REST-протоколу, отправляя и получая данные в формате JSON.

Серверная часть реализована на Java с использованием фреймворка Spring Boot и выступает в роли API-шлюза и основной точки обработки бизнес-логики. Она обеспечивает:

\begin{itemize}
\item аутентификацию и авторизацию пользователей;
\item хранение информации о профилях, вопросах и ответах;
\item маршрутизацию данных между компонентами;
\item взаимодействие с системой рекомендаций через HTTP-интерфейс.
\end{itemize}

База данных (используется PostgreSQL) служит хранилищем для всех структурированных сущностей: пользователей, результатов тестов, заявок на чат и переписок. Для вложений (изображений и аватаров) применяется объектное хранилище, совместимое с S3-протоколом. Кроме того, используется Redis как in-memory кеш для ускорения обработки часто запрашиваемых данных, например, при повторном открытии профиля или списка входящих заявок.

Отдельный компонент системы — сервис рекомендаций, реализованный на Python и развёрнутый как изолированный микросервис. Он не входит напрямую в периметр Java-приложения, но взаимодействует с ним по API. Рекомендательный модуль получает от бэкенда вектор признаков пользователя и возвращает отсортированный список идентификаторов наиболее подходящих партнёров, снабжённый числовой метрикой схожести. Такие предсказания строятся на основе тернарных ответов $q_{u,i} \in \{-1, 0, 1\}$ и, при необходимости, дополнительно учитывают демографические параметры.

С архитектурной точки зрения, система логически разделяется на три уровня:

\begin{enumerate}

\item Клиентский уровень. Представлен Flutter-приложением, которое отвечает за интерактивный ввод, навигацию, отображение данных и обратную связь с пользователем. Также приложение реализует базовую валидацию данных (например, обязательность полей при регистрации) до их отправки на сервер.

\item Уровень бизнес-логики. Серверное приложение на Spring Boot, реализующее REST-контроллеры, обработку авторизации (через JWT), управление данными, транзакции и обработку ошибок. Оно взаимодействует с БД, кешем и внешними сервисами, включая рекомендательную систему.

\item Аналитический уровень. Python-микросервис, реализующий методы коллаборативной фильтрации и другие эвристики. Имеет собственный pipeline подготовки данных (например, регулярное построение матрицы признаков и SVD-декомпозиции) и отвечает на запросы по HTTP.
\end{enumerate}

%На Рисунке~\ref{fig:arch} представлена схема архитектуры клиент-серверной системы.

%{
%	\centering	
%	\includegraphics[width=1\linewidth]{architecture_diagram.jpg}
%	\captionof{figure}{Общая архитектура клиент-серверной системы: взаимодействие между компонентами}
%	\label{fig:arch}
%}

При такой организации достигаются следующие преимущества:

\begin{itemize}
\item  масштабирование микросервисов независимо друг от друга;
\item возможность A/B-тестирования алгоритмов рекомендаций без изменения основного приложения;
\item снижение времени отклика за счёт кеширования;
\item удобство сопровождения: изменения в логике рекомендации не требуют вмешательства в клиент или основное серверное приложение.
\end{itemize}

Каждое взаимодействие клиента и сервера документировано через OpenAPI, что упрощает генерацию SDK и отладку запросов. %Межсервисное взаимодействие логгируется и мониторится с использованием Prometheus и Grafana, что позволяет отслеживать метрики и оперативно реагировать на ошибки.

Безопасность обеспечивается с помощью JWT-токенов для пользователей с проверкой полномочий при доступе к ресурсам.

Таким образом, архитектура системы позволяет гибко расширять функциональность, проводить независимую разработку и тестирование модулей, а также адаптировать систему под рост пользовательской базы без полной переработки существующего кода.


