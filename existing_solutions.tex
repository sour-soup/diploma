% !TeX encoding = windows-1251
\section{Анализ предметной области и существующих решений}

\subsection{Особенности рекомендательных систем}

Рекомендательные системы (РС) являются неотъемлемой частью современных цифровых платформ, предоставляя пользователям персонализированные предложения продуктов, услуг или контента. Они находят широкое применение в различных областях, включая электронную коммерцию, стриминговые сервисы, социальные сети и онлайн-знакомства.

Основные функции рекомендательных систем включают:
\begin{itemize}
	\item отсутствие информации о новых пользователях и объектах (проблема холодного старта);
	\item высокая разреженность пользовательско-объектных матриц;
	\item необходимость обеспечения справедливости и отсутствия предвзятости в рекомендациях\cite{jin2023fairness}.
\end{itemize}

Современные исследования направлены на преодоление этих ограничений, в том числе с использованием больших языковых моделей, методов объяснимого машинного обучения и расширения пользовательского контекста \cite{zhao2023recommender}.

% \subsection{Классификация методов рекомендаций}

% Существует несколько классов методов построения рекомендательных систем, отличающихся используемыми источниками данных и подходами к формированию прогнозов.

% \subsubsection{Коллаборативная фильтрация}

% Основывается на анализе взаимодействий пользователей с объектами (например, оценок, лайков, просмотров). Предполагается, что пользователи с похожим поведением имеют схожие интересы.

% Существуют два подхода:
% \begin{itemize}
% 	\item пользовательская (user-based) — поиск похожих пользователей;
% 	\item объектная (item-based) — поиск похожих объектов.
% \end{itemize}

% Метод хорошо масштабируется и не требует знания характеристик объектов, однако страдает от разреженности и не работает для новых пользователей или объектов \cite{li2025collaborative}.

% \subsubsection{Контентная фильтрация}
% Контентная фильтрация использует характеристики объектов и профили пользователей для формирования рекомендаций. Предполагается, что пользователь предпочитает объекты, схожие с теми, которые ему уже нравились.

% Преимущества:

% \begin{itemize}
% 	\item независимость от данных других пользователей;
% 	\item возможность рекомендаций для новых объектов.
% \end{itemize}

% Недостатки:

% \begin{itemize}
% 	\item ограниченное разнообразие рекомендаций;
% 	\item необходимость в детальном описании объектов.
% \end{itemize}

% Современные подходы к контентной фильтрации включают использование методов обработки естественного языка для анализа текстовых описаний объектов и отзывов пользователей, что позволяет улучшить качество рекомендаций \cite{bao2023content}.


% \subsubsection{Гибридные подходы}

% Гибридные методы объединяют коллаборативную и контентную фильтрации для преодоления ограничений каждого из подходов. Существуют различные стратегии комбинирования, включая:

% \begin{itemize}
% 	\item последовательное применение методов;
% 	\item объединение результатов;
% 	\item интеграция на уровне моделей.
% \end{itemize}

% Гибридные системы демонстрируют повышенную точность и устойчивость к проблемам холодного старта. Современные исследования также рассматривают использование графовых нейронных сетей и методов глубокого обучения в гибридных системах \cite{saini2023hybrid}.

% \subsubsection{Методы глубокого обучения}

% Методы глубокого обучения включают нейронные сети, автоэнкодеры и графовые нейронные сети. Они позволяют учитывать сложные зависимости и контекст, обеспечивая высокое качество предсказаний.

% Преимущества:

% \begin{itemize}
% 	\item способность обрабатывать большие объемы данных;
% 	\item возможность учета различных типов информации.
% \end{itemize}

% Недостатки:

% \begin{itemize}
% 	\item высокая вычислительная сложность;
% 	\item необходимость в больших объемах обучающих данных.
% \end{itemize}

% Современные исследования в области рекомендательных систем на основе глубокого обучения охватывают различные архитектуры и методы, включая сверточные и рекуррентные нейронные сети, а также графовые нейронные сети \cite{zhou2023comprehensive}.

% \subsubsection{Эвристические подходы}

% Эвристические методы основаны на простых правилах и статистике, таких как рекомендации популярных объектов или новинок. Они легко реализуются и не требуют сложных вычислений, но не обеспечивают персонализации и могут быть менее точными.

% Преимущества:

% \begin{itemize}
% 	\item простота реализации;
% 	\item низкая вычислительная сложность.
% \end{itemize}

% Недостатки:

% \begin{itemize}
% 	\item отсутствие персонализации;
% 	\item ограниченное качество рекомендаций.
% \end{itemize}

% Эвристические методы часто используются в качестве базовых моделей или в сочетании с более сложными алгоритмами для улучшения качества рекомендаций \cite{zhang2023review}.


\subsection{Обзор рекомендательных систем в сфере онлайн-знакомств}

Онлайн-сервисы знакомств предъявляют особые требования к алгоритмам рекомендаций. Поскольку конечной целью является установление реального или виртуального контакта между людьми, системы должны максимально точно учитывать совместимость по широкому спектру признаков, при этом оставаясь достаточно лёгкими в вычислении и объяснимыми.

\subsubsection{OkCupid}

OkCupid начала с текстовых анкет и развила модель расчёта совместимости через детальные опросы. Пользователю предлагается до 400 вопросов, ответы на которые кодируются в вектор $q_i \in \{-1,0,1\}$, где значения означают «против», «безразлично» и «за» \cite{hitsch2010mate}.  
Система вычисляет попарную корреляцию ответов двух пользователей:
\[
\mathrm{compat}(u,v)
=\frac{\sum_i w_i\,\mathbf{1}(q_{u,i}=q_{v,i})}{\sum_i w_i},
\]
где $w_i$ — вес вопроса (определяется самим пользователем). Дальнейшее ранжирование учитывает активность и исторические данные о переписках. Такой гибридный подход сочетает content- и collaborative-элементы и позволяет получать качественные рекомендации даже при отсутствии большого числа лайков или свайпов.

\subsubsection{Tinder}

Tinder применяет модель \emph{reciprocal recommendation}: предлагаются только такие профили, которые с наибольшей вероятностью ответят взаимностью \cite{courtois2018tinder}. Основные компоненты алгоритма:
\begin{itemize}
	\item базовый \emph{рейтинговый Эло-подобный механизм}, где свайпы вправо увеличивают рейтинг профиля, влево уменьшают;
	\item измерение \emph{скорости реакции} и \emph{частоты использования} для оценки «живости» аккаунта;
	\item фильтрация неактивных и спорных профилей, чтобы не портить пользовательский опыт.
\end{itemize}
Исследования показывают, что такие меры уменьшают количество односторонних свайпов и повышают вероятность установления диалога между пользователями \cite{pidoux2021tinder}.

\subsubsection{Bumble и Hinge}

Bumble унаследовал от Tinder большинство алгоритмов, но ввёл правило, что первым сообщение отправляет только женщина. Это влияет на ранжирование: при прочих равных предпочтение отдается тем, кто реже получает безответные лайки и чаще инициирует общение \cite{jennings2019tinder}.  
Hinge выделяется принципом «создания общего контекста»: анализируются общие Facebook-друзья, интересы и местоположение. Рекомендации формируются через графовую модель, где вершины — пользователи, а рёбра взвешены по степени близости в социальных связях и ответам на три вступительных вопроса в профиле \cite{bruch2018aspirational}. Это позволяет сегментировать рынок знакомств на локальные сообщества и повышает релевантность для тех, кто ищет знакомых «по кругу общения».

\subsubsection{eHarmony}

eHarmony фокусируется на психологической совместимости. Новый пользователь заполняет обширный личностный опросник, после чего строится профиль в латентном пространстве через метод факторизации матрицы сходств по тестовым шкалам (MMPI и Big Five) \cite{lefebvre2022eharmony}. Дальнейшие рекомендации применяют content-модуль для расширения круга потенциальных партнёров за счёт схожести по интересам и ценностям.

\subsubsection{Coffee Meets Bagel и другие}

Coffee Meets Bagel ежедневно генерирует «порции» (bagels) — ограниченный набор рекомендаций, отбираемых на основе коллаборативной фильтрации и эвристики «совместимых интересов» (аналог OkCupid, но с жёстким ограничением на количество предложений) \cite{lee2021comb}. Такой подход направлен на снижение перегрузки выбором и повышение качества каждого матча.  
Другие сервисы, например Plenty of Fish и Hily, экспериментируют с машинным зрением (анализ фотографий) и NLP (анализ биографий) для дополнительной фильтрации.

\subsubsection{Общие тенденции}

Современные платформы склоняются к гибридным решениям, объединяющим:
\begin{itemize}
	\item анализ анкетных данных и опросов (content);
	\item collaborative filtering и reciprocal recommendation;
	\item эвристики активности и социального контекста;
	\item технологические новации (GNN, NLP, CV) для более глубокой семантической обработки.
\end{itemize}
Таким образом удаётся достичь баланса между качеством рекомендаций и вычислительными ресурсами, что особенно важно для мобильных приложений с высокой нагрузкой.


\subsection{Особенности сбора и представления пользовательских признаков}

В большинстве современных онлайн-сервисов знакомств информация о предпочтениях пользователей строится на основе заранее подготовленных анкет и профилей. При этом традиционные текстовые опросники, как в OkCupid или eHarmony, обеспечивают глубокий анализ личности, но требуют значительного времени от пользователя и зачастую приводят к высокой доле отказов от заполнения. С другой стороны, модели, ориентированные на простой свайп-интерфейс (Tinder, Bumble), существенно упрощают взаимодействие, однако теряют информацию о степени заинтересованности: бинарный выбор «лайк» или «дизлайк» не отражает нюансы отношения и нейтральные позиции.

В предлагаемом подходе используется гибридная модель ввода данных: каждый вопрос теста представлен карточкой, которую пользователь может смахнуть вправо (положительный ответ), влево (отрицательный ответ) или вверх в случае пропуска. Такая схема объединяет скорость и простоту свайпа с более тонкой градацией отклика: положительное, отрицательное и нейтральное отношение. Внутри микросервиса ответы кодируются как тернарные признаки $q_i\in\{-1,0,1\}$, где 1 соответствует явному согласию, $-1$ отражает негативную реакцию, а 0 обозначает отсутствие чёткой позиции. 

Технически процесс сбора строится следующим образом. На клиентской стороне Flutter-приложение загружает набор вопросов с уникальными идентификаторами и последовательно отображает карточки. Каждое действие пользователя сохраняется в буфере и по завершении теста передаётся на бэкенд через REST-запрос. В Python-микросервисе данные проходят валидацию и попадают в таблицу \texttt{user\_responses}, где каждой паре (user\_id, question\_id) соответствует значение $q_i$. При этом фиксируются следующие метаданные: время начала и окончания прохождения теста, число пропущенных вопросов, а также количество повторных попыток. Эти параметры могут служить индикаторами уверенности пользователя в ответах и учитываться в дальнейшей калибровке весов признаков.

Для подготовки к построению рекомендаций ответы разных пользователей формируются в разреженные матрицы по каждому тесту. Элемент матрицы принимает значение $q_{u,i}$ или остаётся пустым (null), если пользователь не проходил конкретный вопрос. При вычислении метрик сходства между векторами профилей применяется нормировка по числу ненулевых элементов: в зависимости от метода это обеспечивает сравнимость результатов для пользователей, прошедших различное количество вопросов. В ряде экспериментов рассматривались методы заполнения пропусков «по умолчанию» нулём, а также замена на среднее значение по вопросу, что позволило оценить влияние стратегий импутации на качество рекомендаций.

Наконец, предусмотрено расширение тернарного вектора демографическими признаками. Пол пользователя кодируется в виде бинарной переменной, возраст — нормируется и входит в общий профиль как вещественный признак. В дальнейшем возможно дополнение текстовым описанием «О себе», представляемым в виде эмбеддингов, извлечённых трансформерными моделями. Однако основной упор сделан на именно тернарные ответы, так как они обеспечивают наиболее компактный и одновременно выразительный способ кодирования предпочтений при минимальной нагрузке на пользователя.

\subsection{Выводы и обоснование выбранного подхода}

Анализ существующих решений в сегменте онлайн-знакомств выявил два крайних сценария: масштабные анкеты с высоким уровнем детализации и простые бинарные свайпы, удобные, но поверхностные. Ни один из этих подходов не совмещает одновременно удобство и глубину представления пользовательских предпочтений. 

Карточно-свайповая модель с тремя вариантами ответа позволяет добиться компромисса. Во-первых, она не предъявляет к пользователю чрезмерных требований по времени и вниманию: одно движение пальцем на экране занимает доли секунды. Во-вторых, введение нейтрального варианта (пропуск) снимает двоичную жёсткость решений, фиксируя менее определённые реакции, которые в дальнейшем помогают точнее выстраивать профиль. Такой подход сходен по механике с Tinder, но обеспечивает информативность, сравнимую с результатами детальных анкет.

Представление данных в виде тернарного вектора позволяет использовать широкий набор методов рекомендаций. Коллаборативная фильтрация на основе SVD легко адаптируется к трем уровням предпочтений, а кластеризация по таким векторам выявляет группы пользователей с близкими моделями отклика. Демографическая фильтрация, применяемая на предварительном этапе, снижает объём вычислений и повышает релевантность кандидатов, исключая явно несовместимые пары по половому и возрастному признаку.

Таким образом, тернарная модель ответов обеспечивает баланс между насыщенностью представления и лёгкостью сбора данных. Именно она лежит в основе предлагаемой архитектуры микросервиса, обеспечивая достаточный объём информации для точных и объяснимых рекомендаций без лишней нагрузки на пользователя. Этот вывод служит отправной точкой для выбора методов CF, кластеризации и эвристик, подробно описываемых в следующих главах.
